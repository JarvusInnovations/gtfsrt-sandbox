version: 2

models:
  - name: fct_tides_vehicle_locations_quality
    description: >
      TIDES vehicle locations with quality indicators.
    columns:
      - name: location_ping_id
        description: '{{ doc("tides_location_ping_id") }}'
      
      - name: service_date
        description: '{{ doc("tides_service_date") }}'
      
      - name: event_timestamp
        description: '{{ doc("tides_event_timestamp") }}'
      
      - name: trip_id_performed
        description: '{{ doc("tides_trip_id_performed") }}'
      
      - name: trip_id_scheduled
        description: '{{ doc("tides_trip_id_scheduled") }}'
      
      - name: trip_stop_sequence
        description: '{{ doc("tides_trip_stop_sequence") }}'
      
      - name: scheduled_stop_sequence
        description: '{{ doc("tides_scheduled_stop_sequence") }}'
      
      - name: vehicle_id
        description: '{{ doc("tides_vehicle_id") }}'
      
      - name: device_id
        description: '{{ doc("tides_device_id") }}'
      
      - name: pattern_id
        description: '{{ doc("tides_pattern_id") }}'
      
      - name: stop_id
        description: '{{ doc("tides_stop_id") }}'
      
      - name: current_status
        description: '{{ doc("tides_current_status") }}'
      
      - name: latitude
        description: '{{ doc("tides_latitude") }}'
      
      - name: longitude
        description: '{{ doc("tides_longitude") }}'
      
      - name: gps_quality
        description: '{{ doc("tides_gps_quality") }}'
      
      - name: heading
        description: '{{ doc("tides_heading") }}'
      
      - name: speed
        description: '{{ doc("tides_speed") }}'
      
      - name: odometer
        description: '{{ doc("tides_odometer") }}'
      
      - name: schedule_deviation
        description: '{{ doc("tides_schedule_deviation") }}'
      
      - name: headway_deviation
        description: '{{ doc("tides_headway_deviation") }}'
      
      - name: trip_type
        description: '{{ doc("tides_trip_type") }}'
      
      - name: schedule_relationship
        description: '{{ doc("tides_schedule_relationship") }}'
      
      - name: is_valid
        description: >
          Indicator for whether this row should be kept in the final mart TIDES model.
          Based on the outcome of all cumulative row-level quality checks. 

      - name: is_first_instance
        description: >
          Indicator for whether this row is the first instance for its 
          event_timestamp + vehicle_id combination when sorted by location_ping_id. 
          First instance is kept in the validity filter.
      
      - name: has_dups
        description: >
          Indicator for whether there was more than one instance of this event_timestamp + vehicle_id combination.
